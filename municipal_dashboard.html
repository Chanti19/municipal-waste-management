<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Municipal Dashboard</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body style="background:#f8f9fa;">
  <div style="display:flex; flex-direction:column; align-items:center; margin-top:32px;">
    <div style="background:#fff; border-radius:24px; box-shadow:0 8px 32px rgba(60,100,180,0.10); padding:32px 48px 24px 48px; min-width:600px; display:flex; flex-direction:column; align-items:center;">
      <div style="width:100%; display:flex; justify-content:space-between; align-items:center;">
        <h1 style="font-size:2.3rem; font-weight:800; margin-bottom:0;">Municipal Dashboard</h1>
        <button class="logout-btn" onclick="logout()" style="margin-left:24px;">
          <svg width="18" height="18" fill="#fff" style="vertical-align:middle; margin-right:6px;" viewBox="0 0 24 24"><path d="M16 13v-2H7V8l-5 4 5 4v-3z"/><path d="M20 19V5a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v4h2V5h10v14H8v-4H6v4a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2z"/></svg>
          Logout
        </button>
      </div>
    </div>

    <div style="display:flex; gap:32px; margin-top:32px;">
      <div class="stat-card" style="flex:1;">
        <div style="display:flex; align-items:center; gap:12px;">
          <span style="background:#e0e7ff; border-radius:12px; padding:10px;">
            <svg width="28" height="28" fill="#2563eb" viewBox="0 0 24 24"><rect width="20" height="20" x="2" y="2" rx="5"/></svg>
          </span>
          <span style="font-weight:600; color:#222;">Total Reports</span>
        </div>
        <div style="font-size:2rem; font-weight:700; color:#2563eb; margin-top:10px;" id="totalReports">0</div>
      </div>
      <div class="stat-card" style="flex:1;">
        <div style="display:flex; align-items:center; gap:12px;">
          <span style="background:#fee2e2; border-radius:12px; padding:10px;">
            <svg width="28" height="28" fill="#ef4444" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><text x="12" y="16" text-anchor="middle" font-size="14" fill="#ef4444">!</text></svg>
          </span>
          <span style="font-weight:600; color:#ef4444;">High Priority</span>
        </div>
        <div style="font-size:2rem; font-weight:700; color:#ef4444; margin-top:10px;" id="highPriority">0</div>
      </div>
      <div class="stat-card" style="flex:1;">
        <div style="display:flex; align-items:center; gap:12px;">
          <span style="background:#fef9c3; border-radius:12px; padding:10px;">
            <svg width="28" height="28" fill="#eab308" viewBox="0 0 24 24"><path d="M3 17l6-6 4 4 8-8"/><path d="M3 17h18"/></svg>
          </span>
          <span style="font-weight:600; color:#eab308;">Medium Priority</span>
        </div>
        <div style="font-size:2rem; font-weight:700; color:#eab308; margin-top:10px;" id="mediumPriority">0</div>
      </div>
      <div class="stat-card" style="flex:1;">
        <div style="display:flex; align-items:center; gap:12px;">
          <span style="background:#d1fae5; border-radius:12px; padding:10px;">
            <svg width="28" height="28" fill="#22c55e" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/></svg>
          </span>
          <span style="font-weight:600; color:#22c55e;">Low Priority</span>
        </div>
        <div style="font-size:2rem; font-weight:700; color:#22c55e; margin-top:10px;" id="lowPriority">0</div>
      </div>
    </div>

    <div style="display:flex; gap:0; margin-top:32px; justify-content:center;">
      <input type="text" id="search" placeholder="Filter by street name..." style="width:320px; padding:16px; border-radius:10px 0 0 10px; border:1.5px solid #e5e7eb; font-size:1.08rem; background:#fff; border-right:none;" oninput="renderReports()" />
      <button onclick="renderReports()" style="background:#2563eb; color:#fff; border:none; border-radius:0 10px 10px 0; padding:0 32px; font-size:1.08rem; font-weight:600; display:flex; align-items:center; gap:8px; cursor:pointer;">
        <svg width="20" height="20" fill="#fff" viewBox="0 0 24 24"><path d="M17.65 6.35a7.95 7.95 0 0 0-11.3 0l-1.42-1.42a9.97 9.97 0 0 1 14.14 0l-1.42 1.42zm-1.42 1.42a5.97 5.97 0 0 0-8.46 0l-1.42-1.42a7.97 7.97 0 0 1 11.3 0l-1.42 1.42zm-1.42 1.42a3.97 3.97 0 0 0-5.62 0l-1.42-1.42a5.97 5.97 0 0 1 8.46 0l-1.42 1.42zm-1.42 1.42a1.97 1.97 0 0 0-2.78 0l-1.42-1.42a3.97 3.97 0 0 1 5.62 0l-1.42 1.42z"/></svg>
        Refresh
      </button>
    </div>

    <div style="margin-top:32px; display:flex; justify-content:center;">
      <div style="background:#fff; border-radius:20px; box-shadow:0 2px 12px rgba(60,100,180,0.07); padding:24px; min-width:400px;">
        <div style="font-size:1.25rem; font-weight:700; color:#222;">Bin Reports</div>
        <div style="color:#555; font-size:1rem; margin-bottom:18px;">Sorted by fill percentage (highest first)</div>
        
        
        <div style="display:flex; justify-content:center; margin-bottom:18px;">
          <button onclick="eraseAllBins()" style="background:#ef4444; color:#fff; border:none; border-radius:8px; padding:12px 28px; font-size:1.08rem; font-weight:600; cursor:pointer;">
            üóëÔ∏è Erase All Data
          </button>
        </div>

        <table style="width:100%; border-collapse:collapse;">
          <thead>
            <tr style="background:#f3f4f6;">
              <th style="padding:12px; text-align:left;">Street</th>
              <th style="padding:12px; text-align:left;">Bin</th>
              <th style="padding:12px; text-align:left;">Fill %</th>
              <th style="padding:12px; text-align:left;">Priority</th>
            </tr>
          </thead>
          <tbody id="reportTable">
            <tr>
              <td colspan="4" style="text-align:center; color:#6b7280; padding:32px;">No bin reports found</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <script src="dsa.js"></script>
  <script>
    function logout() {
      window.location.href = "index.html";
    }

    function getPriority(fill) {
      if (fill >= 80) return "High";
      if (fill >= 50) return "Medium";
      return "Low";
    }

    function renderReports() {
      let data = JSON.parse(localStorage.getItem('binReports') || "[]");
      const filter = document.getElementById('search').value.toLowerCase();
      if (filter) data = data.filter(d => d.street.toLowerCase().includes(filter));
      data = insertionSortDescending(data);

      
      document.getElementById('totalReports').textContent = data.length;
      document.getElementById('highPriority').textContent = data.filter(d => getPriority(d.fill) === "High").length;
      document.getElementById('mediumPriority').textContent = data.filter(d => getPriority(d.fill) === "Medium").length;
      document.getElementById('lowPriority').textContent = data.filter(d => getPriority(d.fill) === "Low").length;

      
      const tbody = document.getElementById('reportTable');
      if (data.length === 0) {
        tbody.innerHTML = `<tr><td colspan="4" style="text-align:center; color:#6b7280; padding:32px;">No bin reports found</td></tr>`;
        return;
      }
      tbody.innerHTML = "";
      data.forEach(d => {
        const pr = getPriority(d.fill);
        let prColor = "#22c55e";
        if (pr === "High") prColor = "#ef4444";
        else if (pr === "Medium") prColor = "#eab308";
        tbody.innerHTML += `<tr>
          <td style="padding:12px;">${d.street}</td>
          <td style="padding:12px;">${d.bin}</td>
          <td style="padding:12px;">${d.fill}%</td>
          <td style="padding:12px; color:${prColor}; font-weight:600;">${pr}</td>
        </tr>`;
      });
    }

    function eraseAllBins() {
      if (confirm("Are you sure you want to erase all bin reports?")) {
        localStorage.removeItem('binReports');
        renderReports();
      }
    }

    
    renderReports();
  </script>
</body>
</html>
